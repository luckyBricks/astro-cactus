---
import ThemeToggle from "./ThemeToggle.astro";

const url = new URL(Astro.request.url);
---

<script>
	import { toggleClass } from "@/util";

	document.addEventListener("DOMContentLoaded", () => {
		const { body } = document;
		const toggleMenuButton = document.getElementById("toggle-navigation-menu");
		let menuOpen = false;

		toggleMenuButton.addEventListener("click", () => {
			toggleClass(body, "menu-open");
			toggleClass(toggleMenuButton, "text-accent");
			menuOpen = !menuOpen;
			toggleMenuButton.setAttribute("aria-expanded", menuOpen.toString());
		});
	});
</script>

<header>
	<span>
		<a
			href="/"
			class="logo"
			aria-current={url.pathname === "/" ? "page" : false}
		>
			<svg
				fill="none"
				xmlns="http://www.w3.org/2000/svg"
				viewBox="0 0 1024 1024"
			>
				<path
					d="M662.4256 937.8816H209.5616c-65.6896 0-118.9376-53.248-118.9376-118.9376V206.592c0-65.6896 53.248-118.9376 118.9376-118.9376h344.1152l227.6352 225.2288v506.0608c0.0512 65.6896-53.1968 118.9376-118.8864 118.9376z"
					fill="#F2942F"
					p-id="1099"></path>
				<path
					d="M178.0224 903.7312h452.864c65.6896 0 118.9376-53.248 118.9376-118.9376V281.6512l-196.096-193.9968H209.5616c-65.6896 0-118.9376 53.248-118.9376 118.9376v612.352c0 22.7328 6.4 43.9296 17.408 62.0032a118.6816 118.6816 0 0 0 69.9904 22.784z"
					fill="#FAB001"
					p-id="1100"></path>
				<path
					d="M556.4416 100.1472H217.8048c-64.6144 0-117.0432 52.3776-117.0432 117.0432v602.5728c0 13.6192 2.3552 26.6752 6.6048 38.8096 16.5888 8.96 35.5328 14.08 55.7056 14.08h445.6448c64.6144 0 117.0432-52.3776 117.0432-117.0432v-487.936l-169.3184-167.5264z"
					fill="#F7BD2D"
					p-id="1101"></path>
				<path
					d="M555.776 121.8048h-325.12c-62.0544 0-112.384 50.3296-112.384 112.384v578.56c0 6.0416 0.512 11.9296 1.3824 17.7152 11.4688 3.9424 23.7056 6.0928 36.5056 6.0928h427.8784c62.0544 0 112.384-50.3296 112.384-112.384V260.9152l-140.6464-139.1104z"
					fill="#FCD430"
					p-id="1102"></path>
				<path
					d="M622.5408 883.5072l-95.3344 51.2c-15.2576 8.192-33.6896-3.1232-33.28-20.4288l2.4064-104.9088c0.256-10.7008 3.1744-21.1456 8.5504-30.4128l303.1552-525.1072a22.00576 22.00576 0 0 1 30.0544-8.0384l103.7824 59.904a22.00576 22.00576 0 0 1 8.0384 30.0544L647.68 859.2896a64.93696 64.93696 0 0 1-25.1392 24.2176z"
					fill="#39AFDA"
					p-id="1103"></path>
				<path
					d="M926.2592 320.0512c2.2528-3.8912 3.1232-8.1408 2.816-12.288a5.376 5.376 0 0 0-2.6624-4.4032l-91.1872-52.6336c-10.496-6.0928-23.9616-2.4576-30.0544 8.0384L504.832 778.9056a63.56992 63.56992 0 0 0-8.5504 30.4128l-2.4064 104.9088c0.9216 0.9728 1.4848 1.536 2.4064 2.5088 3.3792-0.1024 6.8096-0.9216 10.0864-2.6624l95.3344-51.2a64 64 0 0 0 25.088-24.32l299.4688-518.5024z"
					fill="#9CE4F3"
					p-id="1104"></path>
				<path
					d="M613.7856 856.8832L549.632 890.88c-11.4176 8.4992-22.9376 1.2288-20.6336-13.0048l3.4816-66.2016c1.4336-8.8064 4.6592-17.7152 9.4208-25.9584l279.7568-486.4512c5.376-9.3184 15.0016-13.8752 21.504-10.1376l63.9488 36.9152c6.4512 3.7376 7.3728 14.336 1.9456 23.6544l-267.1104 466.0736c-5.2736 9.1136-20.3264 35.2768-28.16 41.1136z"
					fill="#52C5F8"
					p-id="1105"></path>
				<path
					d="M584.4992 346.9312H232.3968c-28.672 0-51.8656-23.2448-51.8656-51.8656 0-28.672 23.2448-51.8656 51.8656-51.8656h352.1024c28.672 0 51.8656 23.2448 51.8656 51.8656 0 28.672-23.2448 51.8656-51.8656 51.8656zM485.7856 581.7856h-253.44c-28.672 0-51.8656-23.2448-51.8656-51.8656 0-28.672 23.2448-51.8656 51.8656-51.8656h253.44c28.672 0 51.8656 23.2448 51.8656 51.8656 0 28.672-23.1936 51.8656-51.8656 51.8656z"
					fill="#F2942F"
					p-id="1106"></path>
				<path
					d="M483.0208 563.5584H231.5264c-23.6032 0-42.752-19.1488-42.752-42.752 0-23.6032 19.1488-42.752 42.752-42.752h251.4944c23.6032 0 42.752 19.1488 42.752 42.752 0 23.6032-19.1488 42.752-42.752 42.752zM579.7888 328.704H231.5264c-23.6032 0-42.752-19.1488-42.752-42.752 0-23.6032 19.1488-42.752 42.752-42.752h348.2624c23.6032 0 42.752 19.1488 42.752 42.752 0 23.6032-19.1488 42.752-42.752 42.752z"
					fill="#9CE4F3"
					p-id="1107"></path>
				<path
					d="M574.72 312.2688H223.2832c-19.0464 0-34.5088-15.4624-34.5088-34.5088s15.4624-34.5088 34.5088-34.5088h351.4368c19.0464 0 34.5088 15.4624 34.5088 34.5088 0.0512 19.0464-15.4112 34.5088-34.5088 34.5088zM481.1264 547.1232H223.488c-19.0464 0-34.5088-15.4624-34.5088-34.5088s15.4624-34.5088 34.5088-34.5088h257.5872c19.0464 0 34.5088 15.4624 34.5088 34.5088 0.0512 19.0464-15.4112 34.5088-34.4576 34.5088z"
					fill="#FFFFFF"
					p-id="1108"></path>
			</svg>
			<span>Bricks' Blog | 偏安一隅</span>
		</a>
		<nav id="navigation-menu" aria-label="Main">
			<a href="/" aria-current={url.pathname === "/" ? "page" : false}>Home</a>
			<a href="/about" aria-current={url.pathname === "/about" ? "page" : false}
				>About
			</a>
			<a href="/posts" aria-current={url.pathname === "/posts" ? "page" : false}
				>Blog
			</a>
		</nav>
	</span>
	<ThemeToggle />
	<button
		id="toggle-navigation-menu"
		type="button"
		aria-label="primary navigation"
		aria-expanded="false"
	>
		<svg
			fill="currentColor"
			viewBox="0 0 20 20"
			xmlns="http://www.w3.org/2000/svg"
		>
			<path
				fill-rule="evenodd"
				d="M3 7a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 13a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
				clip-rule="evenodd"></path>
		</svg>
	</button>
</header>

<style>
	header {
		@apply relative z-50 mb-28 flex items-center sm:pl-[4.5rem];

		.logo {
			@apply inline-flex items-center grayscale hover:filter-none sm:relative sm:inline-block;

			svg {
				@apply mr-3 h-10 w-6 sm:absolute sm:left-[-4.5rem] sm:mr-0 sm:h-20 sm:w-12;
			}

			> span {
				@apply text-xl font-bold sm:text-2xl;
			}
		}

		#toggle-navigation-menu {
			@apply ml-8 sm:invisible sm:hidden;

			svg {
				@apply h-6 w-6;
			}
		}

		nav {
			@apply mt-1 -ml-4 hidden text-accent sm:flex sm:divide-x sm:divide-dashed sm:divide-accent;

			a {
				@apply px-4 sm:hover:underline;
			}
		}

		@media (max-width: 640px) {
			:global(body.menu-open) & {
				@apply relative z-50;

				nav {
					@apply absolute -inset-x-4 top-14 m-0 flex flex-col items-end gap-y-4 rounded-md bg-[color:var(--theme-menu-bg)] py-4 shadow backdrop-blur backdrop-filter;

					a {
						@apply p-4;
					}
				}
			}
		}
	}
</style>
